@api_view(['GET', 'POST'])
# @permission_required('deploy.deploy_add_deploy_inventory',raise_exception=True)
def deploy_host_vars(request, id,format=None):
    try:
        assets = Assets.objects.get(id=id)
    except Assets.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)
    if request.method == 'GET': 
        host_vars = {}   
        if assets.host_vars:
            try:
                host_vars = eval(assets.host_vars)
            except Exception as ex:
                return JsonResponse({'msg':"获取主机变量失败: {ex}".format(ex=ex),"code":500,'data':{}}) 
        return JsonResponse({'msg':"查询成功","code":200,'data':host_vars})  
    elif  request.method == 'POST': 
        host_vars = request.data.get('host_vars',None)
        if host_vars:
            try:
                host_vars = json.dumps(eval(request.data.get('host_vars')))
            except Exception as ex:
                return JsonResponse({'msg':"更新主机变量失败: {ex}".format(ex=ex),"code":500,'data':{}}) 
        assets.host_vars = host_vars
        assets.save()
        return JsonResponse({'msg':"更新成功","code":200,'data':host_vars}) 