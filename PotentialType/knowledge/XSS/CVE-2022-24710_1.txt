This function handles POST requests to generate and return work counts for a specified project or component. It verifies user permissions and input validity before generating the data. Depending on the requested format, it returns the data as either a JSON response or a formatted text/HTML response, detailing various metrics such as counts, edits, and word/character totals.