The function handles unauthorized access attempts by generating an appropriate error response based on the type of request and the user's authentication status. For AJAX requests, it returns a JSON-formatted error message. For other requests, it redirects to a login page with an error message. If the user is authenticated but lacks permission, it raises a problem notification with a link for further action.